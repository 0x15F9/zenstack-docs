---
sidebar_label: 5.7 Field-Level Policies
slug: field-level
---

# Field-Level Policies

In the previous chapters, we've introduced how to write model-level policies to control CRUD permissions. In database terms, this is called row-level-security. With the power of relation traversal, current user access, and flexible expressions and functions, you are fully equipped to handle most real-world authorization scenarios. Sometimes, however, you'll find yourself needing more fine-grained access control.

ZenStack's field-level policies allow you to define access rules for individual fields. For example, you can allow a blog post's owner to update its title and content, but only users with "EDITOR" role to update the "published" field.

The combination of model-level and field-level policies gives you the ultimate granularity and flexibility, and lets ZenStack surpasses Postgres's native [row-level-security](https://www.postgresql.org/docs/current/ddl-rowsecurity.html) capabilities.

### Defining Field-Level Policies

To define a field-level policy, you use the `@allow` and `@deny` field-level attributes to attach rules to fields. Here's an example:

```zmodel
model Post {
    ...
    published Boolean @allow('update', auth().role == EDITOR)
}
```

:::info

You can't use `future()` function in field-level access policies. To express post-update rules, put them into model-level policies. We have an active [feature request](https://github.com/zenstackhq/zenstack/issues/671) for it.

:::

### Difference Between Field-Level and Model-Level Policies

A few key difference between field-level policies and model-level policies:

- Field-level policies only support "read", "update", and "all" operations. It's not meaningful to control "create" and "delete" permissions at the field level.
- Field-level access is by default allowed. If you don't attach any rule to a field, it's accessible as long as the model is accessible. On the contrary, model-level access is denied by default. You'll have to explicitly open up access using `@@allow` attributes.

### Behavior of Field-Level Access Control

A field's accessibility is determined in the following order:

- If no access policies are defined for the field, the operation is allowed
- If any `@deny` rule satisfies, the operation is denied
- If some `@allow` rules are defined and none of them satisfies, the operation is denied
- Otherwise, the operation is allowed

When a "read" operation is denied, the field is dropped from the result. When an "update" operation is denied, the operation is rejected with an error.
